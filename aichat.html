<!DOCTYPE html> <!-- Declares the document type and version of HTML -->
<html lang="en"> <!-- Opens the HTML tag and specifies the language as English -->
<head>
    <meta charset="UTF-8"> <!-- Sets the character encoding for the document to UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Ensures proper rendering and touch zooming on mobile devices -->
    <title>AI Chat</title> <!-- Sets the title of the webpage that appears in the browser tab -->
    <link rel="icon" href="images/Logo.ico"> <!-- Links to the favicon displayed in the browser tab -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" integrity="sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==" crossorigin="anonymous" referrerpolicy="no-referrer" /> <!-- Links to Bootstrap CSS for styling -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400&display=swap" rel="stylesheet"> <!-- Links to the Space Mono font from Google Fonts -->
    <link rel="stylesheet" href="css/aichat.css"> <!-- Links to the custom stylesheet for the AI chat -->
</head>
<body>

    <!-- Canvas for dynamic star effect -->
    <canvas id="canvas"></canvas> <!-- Creates a canvas element for rendering stars -->

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark"> <!-- Starts a Bootstrap navbar with dark background -->
        <a class="navbar-brand" href="index.html">Exoplanet Explorer</a> <!-- Navbar brand link -->
        <div class="navbar-nav"> <!-- Container for navigation links -->
            <a class="nav-link" href="planet-exploring.html">Planet Exploring</a> <!-- Navigation link to Planet Exploring page -->
            <a class="nav-link" href="about.html">About</a> <!-- Navigation link to About page -->
            <a class="nav-link" href="gaming.html">Game</a> <!-- Navigation link to Game page -->
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <!-- Button to toggle navbar on smaller screens -->
            <span class="navbar-toggler-icon"></span> <!-- Icon for the toggler button -->
        </button>
    </nav>

    <!-- AI Chat Section -->
    <section class="chat-container my-5"> <!-- Container for the chat section with margin -->
        <div class="chat-header"> <!-- Header for the chat section -->
            <h2 style="color: white;">AI Chat</h2> <!-- Title of the chat section -->
        </div>
        <div id="chatbox"></div> <!-- Container for displaying chat messages -->
        <textarea id="userInput" class="form-control" rows="4" placeholder="Type your message here..." style="background-color: rgba(255, 255, 255, 0.2); color: #f8f9fa;"></textarea> <!-- Text area for user input -->
        <button id="sendBtn" class="btn btn-primary mt-2">Send</button> <!-- Button to send the message -->
    </section>

    <!-- Footer -->
    <footer>
        <p>Built by Monofeya Heroes Â© 2024</p> <!-- Footer text with copyright information -->
    </footer>

    <!-- Scripts -->
    <script type="importmap"> <!-- Import map for JavaScript modules -->
        {
            "imports": {
                "@google/generative-ai": "https://esm.run/@google/generative-ai" <!-- Maps the generative AI library -->
            }
        }
    </script>
    <script type="module"> <!-- Starts a module script -->
        import { GoogleGenerativeAI } from "@google/generative-ai"; // Imports the Google Generative AI library

        const API_KEY = "AIzaSyDExuD9BLwASoYgnmGMwJZOfC9-OyiWpVY"; // API key for authentication (handle with care)
        const genAI = new GoogleGenerativeAI(API_KEY); // Creates an instance of the Google Generative AI
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" }); // Gets the specified generative model

        const sendBtn = document.getElementById('sendBtn'); // Gets the send button element
        const userInput = document.getElementById('userInput'); // Gets the user input textarea element
        const chatbox = document.getElementById('chatbox'); // Gets the chatbox element

        sendBtn.addEventListener('click', async () => { // Adds a click event listener to the send button
            const userMessage = userInput.value.trim(); // Gets and trims the user input message
            if (userMessage) { // Checks if the user message is not empty
                addMessage(userMessage, 'user'); // Adds the user message to the chat
                userInput.value = ''; // Clears the input field

                const result = await model.generateContent(userMessage); // Generates a response from the AI model
                addMessage(result.response.text(), 'ai'); // Adds the AI response to the chat
            }
        });

        function addMessage(message, sender) { // Function to add a message to the chat
            const messageDiv = document.createElement('div'); // Creates a new div element for the message
            messageDiv.classList.add('message', sender === 'user' ? 'user-message' : 'ai-message'); // Assigns classes based on the sender
            messageDiv.innerHTML = `<p>${message}</p>`; // Sets the inner HTML of the message div
            chatbox.appendChild(messageDiv); // Appends the message div to the chatbox
            chatbox.scrollTop = chatbox.scrollHeight; // Scrolls the chatbox to the bottom
        }

        // Star effect on canvas
        const canvas = document.getElementById('canvas'); // Gets the canvas element
        const ctx = canvas.getContext('2d'); // Gets the 2D rendering context for the canvas
        canvas.width = window.innerWidth; // Sets the canvas width to the window's inner width
        canvas.height = window.innerHeight; // Sets the canvas height to the window's inner height

        // Star generation
        const stars = []; // Initializes an array to hold star objects
        const numStars = 100; // Defines the number of stars to generate
        for (let i = 0; i < numStars; i++) { // Loop to generate stars
            stars.push({
                x: Math.random() * canvas.width, // Random x position within the canvas
                y: Math.random() * canvas.height, // Random y position within the canvas
                size: Math.random() * 2 + 1, // Random size between 1 and 3
                speed: Math.random() * 0.5 + 0.1 // Random speed between 0.1 and 0.6
            });
        }

        // Animation loop
        function animate() { // Function to animate the stars
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clears the canvas for the new frame
            stars.forEach(star => { // Loops through each star in the stars array
                star.y += star.speed; // Moves the star down by its speed
                if (star.y > canvas.height) { // If the star moves out of the bottom of the canvas
                    star.y = 0; // Resets the star's y position to the top
                    star.x = Math.random() * canvas.width; // Assigns a new random x position
                }
                ctx.beginPath(); // Begins a new path for drawing
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2); // Draws a circle for the star
                ctx.fillStyle = 'white'; // Sets the star's color to white
                ctx.fill(); // Fills the star shape with the color
            });
            requestAnimationFrame(animate); // Requests the next frame of the animation
        }
        animate(); // Starts the animation loop
        
        // Change cursor color based on mouse position without following
        const cursor = document.getElementById('cursor'); // Gets the custom cursor element
        document.addEventListener('mousemove', (event) => { // Adds a mousemove event listener to the document
            const { clientX, clientY } = event; // Destructures to get the mouse's x and y coordinates
            const red = Math.round((clientX / window.innerWidth) * 255); // Calculates red value based on mouse x position
            const green = Math.round((clientY / window.innerHeight) * 255); // Calculates green value based on mouse y position
            const blue = 100; // Fixed blue value for cursor color

            const cursorColor = `rgb(${red}, ${green}, ${blue})`; // Creates an RGB color string
            cursor.style.backgroundColor = cursorColor; // Sets the cursor's background color
            cursor.style.transform = `translate(${clientX}px, ${clientY}px)`; // Centers the cursor based on mouse position
        });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.slim.min.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <!-- Links to jQuery library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js" integrity="sha512-TPh2Oxlg1zp+kz3nFA0C5vVC6leG/6mm1z9+mA81MI5eaUVqasPLO8Cuk4gMF4gUfP5etR73rgU/8PNMsSesoQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> <!-- Links to Popper.js for tooltips and popovers -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js" integrity="sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.min.js" integrity="sha512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Links to Bootstrap JS for interactivity -->
</body>
</html>
